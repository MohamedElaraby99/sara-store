@echo off
chcp 65001 >nul
title ูุธุงู ุฅุฏุงุฑุฉ ุงูููุชุจุฉ

:: ุงูุชุญูู ูู ูุฌูุฏ ุงูุจูุฆุฉ ุงููุญูููุฉ
if not exist "portable_env" (
    echo.
    echo โ ุงูุจูุฆุฉ ุงููุญูููุฉ ุบูุฑ ููุฌูุฏุฉ!
    echo ๐ง ูุฑุฌู ุชุดุบูู ููู setup_portable.bat ุฃููุงู
    echo.
    pause
    exit /b 1
)

:: ุชุบููุฑ ุงูุชุฑููุฒ ูุฏุนู ุงูุนุฑุจูุฉ
echo.
echo ===============================================
echo        ูุธุงู ุฅุฏุงุฑุฉ ุงูููุชุจุฉ - ุจุฏุก ุงูุชุดุบูู
echo ===============================================
echo.

:: ุชูุนูู ุงูุจูุฆุฉ ุงููุญูููุฉ
echo ๐ ุชูุนูู ุงูุจูุฆุฉ ุงููุญูููุฉ...
call portable_env\Scripts\activate.bat

:: ุงูุชุญูู ูู ุชุซุจูุช Flask
echo ๐ ุงูุชุญูู ูู ุชุซุจูุช Flask...
portable_env\Scripts\python.exe -c "import flask; print('Flask version:', flask.__version__)" >nul 2>&1
if errorlevel 1 (
    echo โ Flask ุบูุฑ ูุซุจุช ูู ุงูุจูุฆุฉ ุงููุญูููุฉ!
    echo ๐ง ูุฑุฌู ุชุดุบูู setup_portable.bat ูุฑุฉ ุฃุฎุฑู
    pause
    exit /b 1
)
echo โ Flask ูุซุจุช ุจูุฌุงุญ

:: ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
if not exist "library_dev.db" (
    echo ๐๏ธ  ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช...
    portable_env\Scripts\python.exe create_database.py
)

:: ุชุดุบูู ุงูุชุทุจูู
echo.
echo ๐ ุจุฏุก ุชุดุบูู ูุธุงู ุฅุฏุงุฑุฉ ุงูููุชุจุฉ...
echo.
echo ===============================================
echo   ๐ ุฑุงุจุท ุงูุชุทุจูู: http://localhost:5000/dashboard
echo   ๐ค ุงููุณุชุฎุฏู: admin
echo   ๐ ูููุฉ ุงููุฑูุฑ: admin123
echo ===============================================
echo.
echo ๐ ููุงุญุธุฉ: ุงุชุฑู ูุฐู ุงููุงูุฐุฉ ููุชูุญุฉ ุฃุซูุงุก ุงุณุชุฎุฏุงู ุงูุชุทุจูู
echo ๐ ูุฅููุงู ุงูุชุทุจูู: ุงุถุบุท Ctrl+C
echo.
echo ๐ ุณูุชู ูุชุญ ุงููุชุตูุญ ุชููุงุฆูุงู ุฎูุงู 8 ุซูุงู...

:: ูุชุญ ุงููุชุตูุญ ุชููุงุฆูุงู ุจุนุฏ 8 ุซูุงู ูู ุงูุฎูููุฉ
start /min cmd /c "timeout /t 8 /nobreak >nul && start http://localhost:5000/dashboard"

echo โ ุงููุธุงู ุฌุงูุฒ ููุชุดุบูู!
echo ๐ป ุณููุชุญ ุงููุชุตูุญ ุชููุงุฆูุงู ุฎูุงู 8 ุซูุงู...
echo.
echo โ๏ธ  ุฅุฐุง ูู ููุชุญ ุงููุชุตูุญ ุชููุงุฆูุงู:
echo    ุงูุชุญ ุงููุชุตูุญ ูุฏููุงู ูุงุฐูุจ ุฅูู: http://localhost:5000/dashboard
echo.

:: ุชุดุบูู ุงูุชุทุจูู
portable_env\Scripts\python.exe run_dev.py

:: ุฑุณุงูุฉ ุนูุฏ ุฅุบูุงู ุงูุชุทุจูู
echo.
echo ๐ ุชู ุฅุบูุงู ุงูุชุทุจูู ุจูุฌุงุญ
echo.
pause 